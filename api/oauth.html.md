# OAuth


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

This is not yet thoroughly tested. See the [docs
page](https://docs.fastht.ml/explains/oauth.html) for an explanation of
how to use this.

``` python
from IPython.display import Markdown
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fasthtml/blob/main/fasthtml/oauth.py#L22"
target="_blank" style="float:right; font-size:smaller">source</a>

### GoogleAppClient

>      GoogleAppClient (client_id, client_secret, code=None, scope=None,
>                       **kwargs)

*A `WebApplicationClient` for Google oauth2*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fasthtml/blob/main/fasthtml/oauth.py#L40"
target="_blank" style="float:right; font-size:smaller">source</a>

### GitHubAppClient

>      GitHubAppClient (client_id, client_secret, code=None, scope=None,
>                       **kwargs)

*A `WebApplicationClient` for GitHub oauth2*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fasthtml/blob/main/fasthtml/oauth.py#L51"
target="_blank" style="float:right; font-size:smaller">source</a>

### HuggingFaceClient

>      HuggingFaceClient (client_id, client_secret, code=None, scope=None,
>                         state=None, **kwargs)

*A `WebApplicationClient` for HuggingFace oauth2*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fasthtml/blob/main/fasthtml/oauth.py#L65"
target="_blank" style="float:right; font-size:smaller">source</a>

### DiscordAppClient

>      DiscordAppClient (client_id, client_secret, is_user=False, perms=0,
>                        scope=None, **kwargs)

*A `WebApplicationClient` for Discord oauth2*

``` python
cli = GoogleAppClient.from_file('/Users/jhoward/git/_nbs/oauth-test/client_secret.json')
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fasthtml/blob/main/fasthtml/oauth.py#L92"
target="_blank" style="float:right; font-size:smaller">source</a>

### WebApplicationClient.login_link

>      WebApplicationClient.login_link (redirect_uri, scope=None, state=None)

*Get a login link for this client*

Generating a login link that sends the user to the OAuth provider is
done with `client.login_link()`.

It can sometimes be useful to pass state to the OAuth provider, so that
when the user returns you can pick up where they left off. This can be
done by passing the `state` parameter.

``` python
from fasthtml.common import *
from fasthtml.jupyter import *
```

``` python
redir_path = '/redirect'
port = 8000
code_stor = None
```

``` python
app,rt = jupy_app()
server = JupyUvi(app, port=port)
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fasthtml/blob/main/fasthtml/oauth.py#L99"
target="_blank" style="float:right; font-size:smaller">source</a>

### redir_url

>      redir_url (request, redir_path, scheme='https')

*Get the redir url for the host in `request`*

``` python
@rt
def index(request):
    redir = redir_url(request, redir_path)
    return A('login', href=cli.login_link(redir), target='_blank')
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fasthtml/blob/main/fasthtml/oauth.py#L105"
target="_blank" style="float:right; font-size:smaller">source</a>

### \_AppClient.parse_response

>      _AppClient.parse_response (code, redirect_uri)

*Get the token from the oauth2 server response*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fasthtml/blob/main/fasthtml/oauth.py#L115"
target="_blank" style="float:right; font-size:smaller">source</a>

### \_AppClient.get_info

>      _AppClient.get_info (token=None)

*Get the info for authenticated user*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fasthtml/blob/main/fasthtml/oauth.py#L123"
target="_blank" style="float:right; font-size:smaller">source</a>

### \_AppClient.retr_info

>      _AppClient.retr_info (code, redirect_uri)

*Combines `parse_response` and `get_info`*

``` python
@rt(redir_path)
def get(request, code:str):
    redir = redir_url(request, redir_path)
    info = cli.retr_info(code, redir)
    return P(f'Login successful for {info["name"]}!')
```

``` python
HTMX()
```

<iframe src="http://localhost:8000" style="width: 100%; height: auto; border: none;" onload="{
        let frame = this;
        window.addEventListener('message', function(e) {
            if (e.data.height) frame.style.height = (e.data.height+1) + 'px';
        }, false);
    }" allow="accelerometer; autoplay; camera; clipboard-read; clipboard-write; display-capture; encrypted-media; fullscreen; gamepad; geolocation; gyroscope; hid; identity-credentials-get; idle-detection; magnetometer; microphone; midi; payment; picture-in-picture; publickey-credentials-get; screen-wake-lock; serial; usb; web-share; xr-spatial-tracking"></iframe> 

``` python
server.stop()
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fasthtml/blob/main/fasthtml/oauth.py#L130"
target="_blank" style="float:right; font-size:smaller">source</a>

### \_AppClient.retr_id

>      _AppClient.retr_id (code, redirect_uri)

*Call `retr_info` and then return id/subscriber value*

After logging in via the provider, the user will be redirected back to
the supplied redirect URL. The request to this URL will contain a `code`
parameter, which is used to get an access token and fetch the user’s
profile information. See [the explanation
here](https://docs.fastht.ml/explains/oauth.html) for a worked example.
You can either:

- Use client.retr_info(code) to get all the profile information, or
- Use client.retr_id(code) to get just the user’s ID.

After either of these calls, you can also access the access token (used
to revoke access, for example) with `client.token["access_token"]`.

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fasthtml/blob/main/fasthtml/oauth.py#L136"
target="_blank" style="float:right; font-size:smaller">source</a>

### url_match

>      url_match (url, patterns=('^(localhost|127\\.0\\.0\\.1)(:\\d+)?$',))

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/fasthtml/blob/main/fasthtml/oauth.py#L140"
target="_blank" style="float:right; font-size:smaller">source</a>

### OAuth

>      OAuth (app, cli, skip=None, redir_path='/redirect',
>             logout_path='/logout', login_path='/login', https=True,
>             http_patterns=('^(localhost|127\\.0\\.0\\.1)(:\\d+)?$',))

*Initialize self. See help(type(self)) for accurate signature.*
